<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>babel</title>
  <!-- ie에서 es6사용을 위한 babel transcompiler -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.26.0/babel.min.js" integrity="sha512-kp7YHLxuJDJcOzStgd6vtpxr4ZU9kjn77e6dBsivSz+pUuAuMlE2UTdKB7jjsWT84qbS8kdCWHPETnP/ctrFsA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/7.12.1/polyfill.min.js" integrity="sha512-uzOpZ74myvXTYZ+mXUsPhDF+/iL/n32GDxdryI2SJronkEyKC8FBFRLiBQ7l7U/PTYebDbgTtbqTa6/vGtU23A==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <!-- fetch 전용 polyfill -->
  <script src="https://cdn.jsdelivr.net/npm/fetch-polyfill@0.8.2/fetch.min.js"></script>

  <!-- babel 이후에 load할 것!-->
  <!-- bable 이전에 load시 "개체가 'assign' 속성이나 메서드를 지원하지 않습니다." 오류 유발! -->
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <style>
  div {margin: 5px 0;}
  img { width: 200px; border-radius: 50%;}
  </style>
</head>
<body>
  <h1>babel</h1>
  <!--
    ES6 추가된 문법
    - constants
    - arrow-functions
    - block-scoped-functions
    - classes
    - computed-properties
    - destructuring
    - duplicate-keys
    - for of
    - function-name
    - literals
    - modules-amd
    - modules-commonjs
    - object-super
    - parameters
    - shorthand-properties
    - spread
    - sticky-regex
    - template*literals
    - typeof-symbol
    - unicode-regex
  -->
  <button id="btn1">click me</button>
  <script type="text/babel">
  /**
   * 화살표함수
   */
  btn1.onclick = () => {
    console.log("#btn1 clicked!");

    // const let 변수키워드
    const arr = ['a', 'b', 'c'];
    const other = [...arr]; // 전개연산자
    const [a, b, c] = other; // 구조분해할당
    console.log(arr);
    console.log(other);
    console.log(a, b, c);
    
    foo(a, b, c);

  }
  /**
   * 나머지파라미터
   */
  const foo = (...arr) => {
    const alphabets = arr.map((ch, i) => {
      return new Alphabet(ch);
    });
    console.log(alphabets);
    
    const a = 'a', b = 'b';
    /**
     * 객체속성할당 단축문법
     */
    const obj = {
      a, 
      b,
      alphabets
    };
    console.log(obj);
  }

  /**
   * 클래스
   */
  class Alphabet {
    constructor(val){
      this.val = val;
    }
    toString(){
      return `[val=${this.val}]`;
    }
  }
  </script>
  <!-- document.head에 새로 생성된 script -->
  <!-- <script>'use strict';

    var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();
    
    var _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"]) _i["return"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError("Invalid attempt to destructure non-iterable instance"); } }; }();
    
    function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }
    
    /**
     * 화살표함수
     */
    btn1.onclick = function () {
      console.log("#btn1 clicked!");
    
      // const let 변수키워드
      var arr = ['a', 'b', 'c'];
      var other = [].concat(arr); // 전개연산자
    
      var _other = _slicedToArray(other, 3),
          a = _other[0],
          b = _other[1],
          c = _other[2]; // 구조분해할당
    
    
      console.log(arr);
      console.log(other);
      console.log(a, b, c);
    
      foo(a, b, c);
    };
    /**
     * 나머지파라미터
     */
    var foo = function foo() {
      for (var _len = arguments.length, arr = Array(_len), _key = 0; _key < _len; _key++) {
        arr[_key] = arguments[_key];
      }
    
      var alphabets = arr.map(function (ch, i) {
        return new Alphabet(ch);
      });
      console.log(alphabets);
    
      var a = 'a',
          b = 'b';
      /**
       * 객체속성할당 단축
       */
      var obj = {
        a: a,
        b: b,
        alphabets: alphabets
      };
      console.log(obj);
    };
    
    /**
     * 클래스
     */
    
    var Alphabet = function () {
      function Alphabet(val) {
        _classCallCheck(this, Alphabet);
    
        this.val = val;
      }
    
      _createClass(Alphabet, [{
        key: 'toString',
        value: function toString() {
          return '[val=' + this.val + ']';
        }
      }]);
    
      return Alphabet;
    }();
    </script> -->
  
  <div>
    <button id="btn2">promise polifill</button>
    <button id="btn3">fetch polifill</button>
    <button id="btn4">axios</button>
  </div>

  <script type="text/babel" >
  btn2.addEventListener('click', () => {
    console.log("#btn2 clicked!");
    timeoutPromise('안녕',  3000)
      .then((value) => {
        console.log(value);
      });
  });

  const timeoutPromise = (msg, millis) => {
    return new Promise((resolve, reject) => {
      setTimeout(() => resolve(msg), millis);
    });
  };  

  /**
   * babel/stanalone, babel-polyfill외에 fetch-polyfill이 별도로 필요하다.
   * https://cdn.jsdelivr.net/npm/fetch-polyfill@0.8.2/fetch.min.js
   */
  const USER_URL = "https://asia-northeast3-focal-elf-326215.cloudfunctions.net/user";
  btn3.addEventListener('click', () => {
    console.log("#btn3 clicked!");
    fetch(USER_URL)
      .then((response) => response.json())
      .then(console.log);
  });

  /**
   * fetch-polyfill없이 axios도 사용가능하다.
   */
  btn4.addEventListener('click', () => {
    axios(USER_URL)
      .then(({data : {id}}) => console.log(id));
  });
  </script>
   
  <div>
    <button id="btn5">async await</button>
  </div>

  <script type="text/babel" data-presets="es2015,stage-2">
  /**
   * IE11 오류유발 SCRIPT1006: ')'가 필요합니다.
   * 
   * script 아래 속성 필수!
   *  data-presets="es2015,stage-2"
   */
  btn5.addEventListener('click', async () => {
    const {data : {id}} = await axios(USER_URL);
    console.log(id);
  });
  </script>

  <div>
    <button id="btn6">append</button>
    <button id="btn7">remove</button>
  </div>

  <script type="text/babel">
  /**
   * IE는 Element.append를 지원하지 않는다.
   * 대신 Node.appendChild를 사용하자.
   */
  btn6.addEventListener('click', () => {
    const img = document.createElement('img');
    img.id = 'hyunta';
    img.src = '../sample/image/hyunta.jpg';
    // document.body.append(img); // 개체가 'append' 속성이나 메서드를 지원하지 않습니다.
    document.body.appendChild(img); 
  });
  /**
   * IE는 remove를 지원하지 않는다.
   * 부모요소를 찾아 removeChild를 사용하자.
   */
  btn7.addEventListener('click', () => {
    // hyunta.remove(); // 개체가 'remove' 속성이나 메서드를 지원하지 않습니다.
    hyunta.parentElement.removeChild(hyunta);
  });
  </script>

</body>
</html>